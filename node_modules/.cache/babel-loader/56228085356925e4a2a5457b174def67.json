{"ast":null,"code":"var _jsxFileName = \"W:\\\\Study\\\\BlogReactUI\\\\reactblogproject\\\\src\\\\article\\\\article.js\";\nimport React from 'react';\nimport { List, Avatar, Icon, Col, Row, message } from 'antd';\nimport Profile from './profile';\nimport { connect } from 'react-redux';\nimport { getarticlelist, getarticlecollect } from '../store/action';\nimport axios from 'axios';\nconst delarticleurl = '/api/delarticle';\nconst getarticleurl = '/api/getarticle';\nconst updatearticlelike = '/api/updatelike';\nconst updatearticlecollect = '/api/updatecollect';\n\nclass Article extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.collectfunc = (item, articlecollect) => {\n      if (!this.props.user) {\n        message.error(\"请登录后收藏\");\n        return;\n      }\n\n      for (let i = 0; i < articlecollect.length; i++) {\n        if (articlecollect[i] === item.dateid) {\n          articlecollect.splice(i, 1);\n          getarticlecollect(articlecollect);\n          this.setState({});\n          return;\n        }\n      }\n\n      articlecollect.push(item.dateid);\n      getarticlecollect(articlecollect);\n      this.setState({});\n    };\n\n    this.likefunc = function (item, index) {\n      if (!this.props.user) {\n        message.error(\"请登录后点赞\");\n        return;\n      }\n\n      for (let i = 0; i < item.like.length; i++) {\n        if (item.like[i] === this.props.user) {\n          item.like.splice(i, 1);\n          this.setState({});\n          return;\n        }\n      }\n\n      item.like.push(this.props.user);\n      this.setState({});\n    };\n\n    this.commentfunc = () => {\n      console.log('commentfunc');\n    };\n\n    this.delfunc = (item, e) => {\n      e.preventDefault();\n      let sendobj = {\n        \"dateid\": item.dateid\n      };\n      axios({\n        url: delarticleurl,\n        method: 'post',\n        data: sendobj\n      }).then(res => {\n        let data = res.data;\n\n        if (data === 'success') {\n          message.success(\"删除成功\");\n          let index;\n\n          for (let i = 0; i < this.props.articlelist.length; i++) {\n            if (this.props.articlelist[i]['dateid'] === item.dateid) {\n              index = i;\n            }\n          }\n\n          let changelist = this.props.articlelist;\n          changelist.splice(index, 1);\n          this.props.getarticlelist(changelist);\n          this.setState({});\n        } else {\n          message.error(\"删除失败\");\n        }\n      });\n    };\n\n    if (props.articlelist.length === 0) {\n      axios({\n        url: getarticleurl,\n        method: 'post',\n        data: {}\n      }).then(res => {\n        let data = res.data;\n        data = data.reverse();\n        this.props.getarticlelist(data);\n        this.setState({\n          value: ''\n        });\n      }).catch(e => {\n        console.log(e);\n      });\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.props.islogin) {\n      let sendobj = {\n        'articlelist': this.props.articlelist\n      };\n      axios({\n        url: updatearticlelike,\n        method: 'post',\n        data: sendobj\n      }).then(res => {\n        let data = res.data;\n\n        if (data === 'success') {\n          console.log('update');\n        } else console.log(data);\n      }).catch(err => {\n        console.log(err);\n      });\n      let sendarticle = {\n        'articlecollect': this.props.articlecollect,\n        'user': this.props.user\n      };\n      axios({\n        url: updatearticlecollect,\n        method: 'post',\n        data: sendarticle\n      }).then(res => {\n        let data = res.data;\n\n        if (data === 'success') {\n          console.log('update');\n        } else {\n          console.log(data);\n        }\n      });\n    }\n  }\n\n  render() {\n    let articlecollect = this.props.articlecollect;\n    return React.createElement(Row, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123\n      },\n      __self: this\n    }, React.createElement(Col, {\n      xs: {\n        span: 0\n      },\n      xl: {\n        span: 6\n      },\n      style: {\n        height: '100px'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124\n      },\n      __self: this\n    }), React.createElement(Col, {\n      xs: {\n        span: 24\n      },\n      xl: {\n        span: 10\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125\n      },\n      __self: this\n    }, React.createElement(List, {\n      itemLayout: \"vertical\",\n      size: \"large\",\n      pagination: {\n        pageSize: 5\n      },\n      dataSource: this.props.articlelist,\n      renderItem: (item, index) => React.createElement(List.Item, {\n        key: item.dateid,\n        actions: [React.createElement(\"span\", {\n          onClick: this.collectfunc.bind(this, item, articlecollect),\n          style: {\n            color: articlecollect.includes(item.dateid) ? 'red' : ''\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 137\n          },\n          __self: this\n        }, React.createElement(Icon, {\n          type: \"star-o\",\n          style: {\n            marginRight: 8\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 138\n          },\n          __self: this\n        }), \"\\u6536\\u85CF\"), React.createElement(\"span\", {\n          onClick: this.likefunc.bind(this, item, index),\n          style: {\n            color: item.like.includes(this.props.user) ? 'red' : ''\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 141\n          },\n          __self: this\n        }, React.createElement(Icon, {\n          type: \"like-o\",\n          style: {\n            marginRight: 8\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 142\n          },\n          __self: this\n        }), item.like.length), React.createElement(\"span\", {\n          onClick: this.commentfunc.bind(this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 145\n          },\n          __self: this\n        }, React.createElement(Icon, {\n          type: \"message\",\n          style: {\n            marginRight: 8\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 146\n          },\n          __self: this\n        }), item.comment.length), React.createElement(\"a\", {\n          onClick: this.delfunc.bind(this, item),\n          href: \"/\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 149\n          },\n          __self: this\n        }, item.account === this.props.user ? \"删除\" : \"\")],\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134\n        },\n        __self: this\n      }, React.createElement(List.Item.Meta, {\n        avatar: React.createElement(Avatar, {\n          src: item.headurl,\n          size: 50,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 152\n          },\n          __self: this\n        }),\n        title: React.createElement(\"a\", {\n          href: '/articledetail/' + item.dateid,\n          className: \"apoint\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 153\n          },\n          __self: this\n        }, item.title),\n        description: item.author,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152\n        },\n        __self: this\n      })),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126\n      },\n      __self: this\n    })), React.createElement(Col, {\n      xs: {\n        span: 0\n      },\n      xl: {\n        span: 4\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160\n      },\n      __self: this\n    }, React.createElement(Profile, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161\n      },\n      __self: this\n    })), React.createElement(Col, {\n      xs: {\n        span: 0\n      },\n      xl: {\n        span: 6\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163\n      },\n      __self: this\n    }));\n  }\n\n}\n\nexport default connect((props, state) => Object.assign({}, props, state), {\n  getarticlelist\n})(Article);","map":{"version":3,"sources":["W:\\Study\\BlogReactUI\\reactblogproject\\src\\article\\article.js"],"names":["React","List","Avatar","Icon","Col","Row","message","Profile","connect","getarticlelist","getarticlecollect","axios","delarticleurl","getarticleurl","updatearticlelike","updatearticlecollect","Article","Component","constructor","props","collectfunc","item","articlecollect","user","error","i","length","dateid","splice","setState","push","likefunc","index","like","commentfunc","console","log","delfunc","e","preventDefault","sendobj","url","method","data","then","res","success","articlelist","changelist","reverse","value","catch","componentWillUnmount","islogin","err","sendarticle","render","span","height","pageSize","bind","color","includes","marginRight","comment","account","headurl","title","author","state","Object","assign"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport {List,Avatar,Icon,Col,Row,message} from 'antd';\r\nimport Profile from './profile';\r\nimport { connect } from 'react-redux';\r\nimport {getarticlelist,getarticlecollect} from '../store/action';\r\nimport axios from 'axios';\r\n\r\nconst delarticleurl='/api/delarticle';\r\nconst getarticleurl='/api/getarticle';\r\nconst updatearticlelike='/api/updatelike';\r\nconst updatearticlecollect='/api/updatecollect';\r\n\r\nclass Article extends React.Component{\r\n    constructor(props){\r\n        super(props);\r\n        if(props.articlelist.length===0){\r\n          axios({\r\n            url:getarticleurl,\r\n            method:'post',\r\n            data:{}\r\n          }).then((res)=>{\r\n            let data=res.data;\r\n            data=data.reverse();\r\n            this.props.getarticlelist(data);\r\n            this.setState({value:''});\r\n          }).catch((e)=>{console.log(e)})\r\n       }\r\n    }\r\n    collectfunc=(item,articlecollect)=>{\r\n      if(!this.props.user){\r\n        message.error(\"请登录后收藏\")\r\n        return\r\n      }\r\n      for(let i=0;i<articlecollect.length;i++){\r\n        if(articlecollect[i]===item.dateid){\r\n          articlecollect.splice(i,1);\r\n          getarticlecollect(articlecollect);\r\n          this.setState({});\r\n          return\r\n        }\r\n      }  \r\n      articlecollect.push(item.dateid);\r\n      getarticlecollect(articlecollect);\r\n      this.setState({});\r\n    }\r\n    likefunc=function (item,index){\r\n      if(!this.props.user){\r\n        message.error(\"请登录后点赞\")\r\n        return\r\n      }\r\n      for(let i=0;i<item.like.length;i++){\r\n        if(item.like[i]===this.props.user){\r\n          item.like.splice(i,1);\r\n          this.setState({});\r\n          return\r\n        }\r\n      }\r\n      item.like.push(this.props.user);\r\n      this.setState({});\r\n    }\r\n    commentfunc=()=>{\r\n      console.log('commentfunc');\r\n    }\r\n    delfunc=(item,e)=>{\r\n      e.preventDefault();\r\n      let sendobj = {\"dateid\":item.dateid};\r\n        axios({\r\n          url:delarticleurl,\r\n        method:'post',\r\n        data:sendobj\r\n      }).then((res)=>{\r\n        let data=res.data;\r\n        if(data==='success'){\r\n          message.success(\"删除成功\");\r\n          let index;\r\n          for(let i=0;i<this.props.articlelist.length;i++){\r\n            if(this.props.articlelist[i]['dateid']===item.dateid){\r\n              index=i;\r\n            }\r\n          }\r\n          let changelist =this.props.articlelist;\r\n          changelist.splice(index,1);\r\n          this.props.getarticlelist(changelist);\r\n          this.setState({});\r\n        }else{\r\n          message.error(\"删除失败\")\r\n        }\r\n      })\r\n    }\r\n    componentWillUnmount(){\r\n      if(this.props.islogin){\r\n      let sendobj={'articlelist':this.props.articlelist}\r\n      axios({\r\n        url:updatearticlelike,\r\n        method:'post',\r\n        data:sendobj\r\n      }).then((res)=>{\r\n        let data=res.data;\r\n        if(data==='success'){\r\n          console.log('update')\r\n        }else(console.log(data))\r\n      }).catch((err)=>{console.log(err)})\r\n      let sendarticle={\r\n        'articlecollect':this.props.articlecollect,\r\n        'user':this.props.user\r\n      }\r\n      axios({\r\n        url:updatearticlecollect,\r\n        method:'post',\r\n        data:sendarticle\r\n      }).then((res)=>{\r\n        let data=res.data;\r\n        if(data==='success'){\r\n          console.log('update');\r\n        }else{\r\n          console.log(data);\r\n        }\r\n      })\r\n    }}\r\n    render(){\r\n        let articlecollect=this.props.articlecollect\r\n        return(\r\n            <Row >\r\n            <Col xs={{span:0}} xl={{span:6}} style={{height:'100px'}}></Col>\r\n            <Col xs={{span:24}} xl={{span:10}}>\r\n            <List\r\n              itemLayout=\"vertical\"\r\n              size=\"large\"\r\n              pagination={{\r\n                pageSize: 5,\r\n              }}\r\n              dataSource={this.props.articlelist}\r\n              renderItem={(item,index) => (\r\n                <List.Item\r\n                    key={item.dateid}\r\n                    actions={[\r\n                      <span onClick={this.collectfunc.bind(this,item,articlecollect)} style={{color:articlecollect.includes(item.dateid)?'red':''}}>\r\n                        <Icon type=\"star-o\" style={{ marginRight: 8 }} />\r\n                        收藏\r\n                      </span>,\r\n                      <span onClick={this.likefunc.bind(this,item,index)} style={{color:item.like.includes(this.props.user)?'red':''}} >\r\n                        <Icon type=\"like-o\" style={{ marginRight: 8 }} />\r\n                        {item.like.length}\r\n                      </span>,\r\n                      <span onClick={this.commentfunc.bind(this)} >\r\n                        <Icon type=\"message\" style={{ marginRight: 8 }} />\r\n                        {item.comment.length}\r\n                      </span>,\r\n                      <a onClick={this.delfunc.bind(this,item)} href='/'>{item.account===this.props.user?\"删除\":\"\"}</a>\r\n                    ]}\r\n                >\r\n                  <List.Item.Meta avatar={<Avatar src={item.headurl} size={50} />}\r\n                    title={<a href={'/articledetail/'+item.dateid} className=\"apoint\">{item.title}</a>}\r\n                    description={item.author}\r\n                    />\r\n                </List.Item>\r\n              )}\r\n            />\r\n            </Col>\r\n              <Col xs={{span:0}} xl={{span:4}}>\r\n               <Profile></Profile>\r\n              </Col>\r\n              <Col xs={{span:0}} xl={{span:6}}></Col>\r\n              </Row>\r\n        )     \r\n    }\r\n}\r\nexport default connect((props,state)=>(Object.assign({},props,state)),{getarticlelist})(Article)"]},"metadata":{},"sourceType":"module"}