{"ast":null,"code":"var _jsxFileName = \"W:\\\\Study\\\\BlogReactUI\\\\reactblogproject\\\\src\\\\article\\\\profiledetail.js\";\nimport { Upload, Icon, Col, Row, Modal, Menu, Form, Input, Button, message } from 'antd';\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { getnickname, getheadurl } from '../store/action';\nimport axios from 'axios';\nconst modifyurl = '/api/updateuser';\nconst uploadurl = '/api/photos/upload';\n\nclass ModifynickForm extends React.Component {\n  constructor(...args) {\n    super(...args);\n\n    this.Submitnick = e => {\n      e.preventDefault();\n      this.props.form.validateFieldsAndScroll((err, values) => {\n        if (!err) {\n          let sendobj = {\n            'nickname': values.nickname,\n            'user': this.props.userinfo.user\n          };\n          axios({\n            url: modifyurl,\n            method: 'post',\n            data: sendobj\n          }).then(res => {\n            let data = res.data;\n\n            if (data === 'success') {\n              message.success(\"操作成功\");\n              this.props.getnickname(values.nickname);\n              this.setState({});\n            } else {\n              message.error(\"操作失败\");\n            }\n          }).catch(e => {\n            console.log(e);\n          });\n        }\n      });\n    };\n  }\n\n  render() {\n    const getFieldDecorator = this.props.form.getFieldDecorator;\n    const formItemLayout = {\n      labelCol: {\n        span: 6\n      },\n      wrapperCol: {\n        span: 18\n      }\n    };\n    return React.createElement(Form, {\n      onSubmit: this.Submitnick,\n      layout: \"horizontal\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 40\n      },\n      __self: this\n    }, React.createElement(Form.Item, Object.assign({\n      label: \"\\u4FEE\\u6539\\u6635\\u79F0\"\n    }, formItemLayout, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 41\n      },\n      __self: this\n    }), getFieldDecorator('nickname', {\n      rules: [{\n        required: true,\n        message: '请输入昵称'\n      }],\n      initialValue: this.props.userinfo.nickname\n    })(React.createElement(Input, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 50\n      },\n      __self: this\n    }))), React.createElement(Form.Item, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 52\n      },\n      __self: this\n    }, React.createElement(Button, {\n      type: \"primary\",\n      htmlType: \"submit\",\n      style: {\n        float: 'right'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 53\n      },\n      __self: this\n    }, \"\\u4FEE\\u6539\")));\n  }\n\n}\n\nconst Modifynick = Form.create()(ModifynickForm);\n\nclass ModifypassForm extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      confirmDirty: false\n    };\n\n    this.compareToFirstPassword = (rule, value, callback) => {\n      const form = this.props.form;\n\n      if (value && value !== form.getFieldValue('password')) {\n        callback('两次密码输入不一致');\n      } else {\n        callback();\n      }\n    };\n\n    this.validateToNextPassword = (rule, value, callback) => {\n      const form = this.props.form;\n\n      if (value && this.state.confirmDirty) {\n        form.validateFields(['confirm'], {\n          force: true\n        });\n      }\n\n      callback();\n    };\n\n    this.handleConfirmBlur = e => {\n      const value = e.target.value;\n      this.setState({\n        confirmDirty: this.state.confirmDirty || !!value\n      });\n    };\n\n    this.Submitpass = e => {\n      e.preventDefault();\n      this.props.form.validateFieldsAndScroll((err, values) => {\n        if (!err) {\n          let sendobj = {\n            'password': values.password,\n            'user': this.props.userinfo.user\n          };\n          axios({\n            url: modifyurl,\n            method: 'post',\n            data: sendobj\n          }).then(res => {\n            let data = res.data;\n\n            if (data === 'success') {\n              message.success(\"操作成功\");\n              this.props.form.setFieldsValue({\n                'password': ''\n              });\n              this.props.form.setFieldsValue({\n                'confirm': ''\n              });\n              this.setState({});\n            } else {\n              message.error(\"操作失败\");\n            }\n          }).catch(e => {\n            console.log(e);\n          });\n        }\n      });\n    };\n  }\n\n  render() {\n    const getFieldDecorator = this.props.form.getFieldDecorator;\n    const formItemLayout = {\n      labelCol: {\n        span: 6\n      },\n      wrapperCol: {\n        span: 18\n      }\n    };\n    return React.createElement(Form, {\n      onSubmit: this.Submitpass,\n      layout: \"horizontal\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116\n      },\n      __self: this\n    }, React.createElement(Form.Item, Object.assign({\n      label: \"\\u4FEE\\u6539\\u5BC6\\u7801\"\n    }, formItemLayout, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117\n      },\n      __self: this\n    }), getFieldDecorator('password', {\n      rules: [{\n        required: true,\n        message: '请输入密码'\n      }, {\n        validator: this.validateToNextPassword\n      }]\n    })(React.createElement(Input.Password, {\n      placeholder: \"\\u8BF7\\u8F93\\u5165\\u5BC6\\u7801\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    }))), React.createElement(Form.Item, Object.assign({\n      label: \"\\u786E\\u8BA4\\u5BC6\\u7801\"\n    }, formItemLayout, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130\n      },\n      __self: this\n    }), getFieldDecorator('confirm', {\n      rules: [{\n        required: true,\n        message: '请确认密码'\n      }, {\n        validator: this.compareToFirstPassword\n      }]\n    })(React.createElement(Input.Password, {\n      onBlur: this.handleConfirmBlur,\n      placeholder: \"\\u8BF7\\u786E\\u8BA4\\u5BC6\\u7801\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141\n      },\n      __self: this\n    }))), React.createElement(Form.Item, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143\n      },\n      __self: this\n    }, React.createElement(Button, {\n      type: \"primary\",\n      htmlType: \"submit\",\n      style: {\n        float: 'right'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144\n      },\n      __self: this\n    }, \"\\u4FEE\\u6539\")));\n  }\n\n}\n\nconst Modifypass = Form.create()(ModifypassForm);\n\nclass Modifyhead extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.handleCancel = () => this.setState({\n      previewVisible: false\n    });\n\n    this.handlePreview = async file => {\n      if (!file.url && !file.preview) {\n        file.preview = await getBase64(file.originFileObj);\n      }\n\n      this.setState({\n        previewImage: file.url || file.preview,\n        previewVisible: true\n      });\n    };\n\n    this.Submithead = e => {\n      if (this.state.fileList[0]) {\n        let headurl = '/api/' + this.state.fileList[0].response.jpgurl;\n        let sendobj = {\n          'headurl': headurl,\n          'user': this.props.userinfo.user\n        };\n        axios({\n          url: modifyurl,\n          method: 'post',\n          data: sendobj\n        }).then(res => {\n          let data = res.data;\n\n          if (data === 'success') {\n            this.props.getheadurl(headurl);\n            message.success('更换成功');\n            this.setState({});\n          } else {\n            message.error('更换失败');\n          }\n        }).catch(e => {\n          console.log(e);\n        });\n      }\n    };\n\n    this.handleChange = ({\n      fileList\n    }) => {\n      console.log(fileList);\n      this.setState({\n        fileList\n      });\n    };\n\n    this.state = {\n      previewVisible: false,\n      previewImage: '',\n      fileList: [{\n        uid: '-1',\n        url: props.userinfo.headurl\n      }]\n    };\n  }\n\n  render() {\n    const _this$state = this.state,\n          previewVisible = _this$state.previewVisible,\n          previewImage = _this$state.previewImage,\n          fileList = _this$state.fileList;\n    const uploadButton = React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      type: \"plus\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"ant-upload-text\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204\n      },\n      __self: this\n    }, \"Upload\"));\n    return React.createElement(\"div\", {\n      className: \"uploaddiv\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208\n      },\n      __self: this\n    }, React.createElement(Upload, {\n      action: uploadurl,\n      listType: \"picture-card\",\n      fileList: fileList,\n      onPreview: this.handlePreview,\n      onChange: this.handleChange,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209\n      },\n      __self: this\n    }, fileList.length >= 1 ? null : uploadButton), React.createElement(Modal, {\n      visible: previewVisible,\n      footer: null,\n      onCancel: this.handleCancel,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      alt: \"example\",\n      style: {\n        width: '100%'\n      },\n      src: previewImage,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219\n      },\n      __self: this\n    })), React.createElement(Button, {\n      onClick: this.Submithead,\n      style: {\n        width: '104px'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 221\n      },\n      __self: this\n    }, \"\\u786E\\u8BA4\\u4FEE\\u6539\"));\n  }\n\n}\n\nfunction getBase64(file) {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.readAsDataURL(file);\n\n    reader.onload = () => resolve(reader.result);\n\n    reader.onerror = error => reject(error);\n  });\n}\n\nclass Profiledetail extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.handleClick = e => {\n      this.setState({\n        current: e.key\n      });\n    };\n\n    this.state = {\n      current: 'nickname'\n    };\n\n    if (props.islogin) {} else {\n      message.warn(\"请登录后使用\");\n      props.history.push('/article');\n    }\n  }\n\n  render() {\n    const userinfo = {\n      'nickname': this.props.nickname,\n      'user': this.props.user,\n      'headurl': this.props.headurl\n    };\n    return React.createElement(Row, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 261\n      },\n      __self: this\n    }, React.createElement(Col, {\n      xs: {\n        span: 0\n      },\n      xl: {\n        span: 4\n      },\n      style: {\n        height: 100\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 262\n      },\n      __self: this\n    }), React.createElement(Col, {\n      xs: {\n        span: 4\n      },\n      xl: {\n        span: 4\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 263\n      },\n      __self: this\n    }, React.createElement(Menu, {\n      onClick: this.handleClick,\n      style: {\n        width: 256\n      },\n      defaultSelectedKeys: ['nickname'],\n      mode: \"inline\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 264\n      },\n      __self: this\n    }, React.createElement(Menu.Item, {\n      key: \"nickname\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 270\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      type: \"user\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 271\n      },\n      __self: this\n    }), \"\\u4FEE\\u6539\\u6635\\u79F0\"), React.createElement(Menu.Item, {\n      key: \"lock\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 273\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      type: \"lock\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 274\n      },\n      __self: this\n    }), \"\\u4FEE\\u6539\\u5BC6\\u7801\"), React.createElement(Menu.Item, {\n      key: \"head\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 276\n      },\n      __self: this\n    }, React.createElement(Icon, {\n      type: \"contacts\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 277\n      },\n      __self: this\n    }), \"\\u4FEE\\u6539\\u5934\\u50CF\"))), React.createElement(Col, {\n      xs: {\n        span: 20\n      },\n      xl: {\n        span: 8\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 281\n      },\n      __self: this\n    }, this.state.current === 'nickname' ? React.createElement(Modifynick, {\n      userinfo: userinfo,\n      getnickname: this.props.getnickname,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 283\n      },\n      __self: this\n    }) : this.state.current === 'lock' ? React.createElement(Modifypass, {\n      userinfo: userinfo,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 284\n      },\n      __self: this\n    }) : React.createElement(Modifyhead, {\n      userinfo: userinfo,\n      getheadurl: this.props.getheadurl,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 285\n      },\n      __self: this\n    })), React.createElement(Col, {\n      xs: {\n        span: 0\n      },\n      xl: {\n        span: 8\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 287\n      },\n      __self: this\n    }));\n  }\n\n}\n\nexport default connect((props, state) => Object.assign({}, props, state), {\n  getnickname,\n  getheadurl\n})(Profiledetail); // <Form onSubmit={this.handleSubmit} className=\"login-form\">\n// <Form.Item>\n//   {getFieldDecorator('username', {\n//     rules: [\n//       {\n//         type: 'email',\n//         message: '请输入邮箱格式',\n//       },\n//       {\n//         required: true,\n//         message: '请输入邮箱',\n//       },\n//     ],\n//   })(\n//     <Input\n//       prefix={<Icon type=\"mail\" style={{ color: 'rgba(0,0,0,.25)' }} />}\n//       placeholder=\"请输入邮箱\"\n//     />,\n//   )}\n// </Form.Item>\n// <Form.Item>\n//   {getFieldDecorator('password', {\n//     rules: [{ required: true, message: '请输入密码' }],\n//   })(\n//     <Input\n//       prefix={<Icon type=\"lock\" style={{ color: 'rgba(0,0,0,.25)' }} />}\n//       type=\"password\"\n//       placeholder=\"请输入密码\"\n//     />,\n//   )}\n// </Form.Item>\n// <Form.Item>\n// <div>\n//   {getFieldDecorator('remember', {\n//     valuePropName: 'checked',\n//     initialValue: true,\n//   })(<Checkbox>记住我</Checkbox>)}\n//   <a className=\"login-form-forgot\" href=\"#\">\n//     忘记密码\n//   </a>\n//   </div>\n//   <Button type=\"primary\" htmlType=\"submit\" className=\"login-form-button\">\n//     登录\n//   </Button>\n// </Form.Item>\n// <div className=\"clearfix\">\n//   <Upload\n//     action=\"https://www.mocky.io/v2/5cc8019d300000980a055e76\"\n//     listType=\"picture-card\"\n//     fileList={fileList}\n//     onPreview={this.handlePreview}\n//     onChange={this.handleChange}\n//   >\n//     {fileList.length >= 1 ? null : uploadButton}\n//   </Upload>\n//   <Modal visible={previewVisible} footer={null} onCancel={this.handleCancel}>\n//   <img alt=\"example\" style={{ width: '100%' }} src={previewImage} />\n//   </Modal>\n// </div>\n// </Form>","map":{"version":3,"sources":["W:\\Study\\BlogReactUI\\reactblogproject\\src\\article\\profiledetail.js"],"names":["Upload","Icon","Col","Row","Modal","Menu","Form","Input","Button","message","React","connect","getnickname","getheadurl","axios","modifyurl","uploadurl","ModifynickForm","Component","Submitnick","e","preventDefault","props","form","validateFieldsAndScroll","err","values","sendobj","nickname","userinfo","user","url","method","data","then","res","success","setState","error","catch","console","log","render","getFieldDecorator","formItemLayout","labelCol","span","wrapperCol","rules","required","initialValue","float","Modifynick","create","ModifypassForm","state","confirmDirty","compareToFirstPassword","rule","value","callback","getFieldValue","validateToNextPassword","validateFields","force","handleConfirmBlur","target","Submitpass","password","setFieldsValue","validator","Modifypass","Modifyhead","constructor","handleCancel","previewVisible","handlePreview","file","preview","getBase64","originFileObj","previewImage","Submithead","fileList","headurl","response","jpgurl","handleChange","uid","uploadButton","length","width","Promise","resolve","reject","reader","FileReader","readAsDataURL","onload","result","onerror","Profiledetail","handleClick","current","key","islogin","warn","history","push","height","Object","assign"],"mappings":"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","sourcesContent":["import {Upload,Icon,Col,Row,Modal,Menu,Form,Input,Button,message} from 'antd';\r\nimport React from 'react';\r\nimport {connect} from 'react-redux';\r\nimport {getnickname,getheadurl} from '../store/action'\r\nimport axios from 'axios';\r\n\r\nconst modifyurl='/api/updateuser';\r\nconst uploadurl='/api/photos/upload';\r\n\r\nclass ModifynickForm extends React.Component{\r\n  Submitnick=(e)=>{\r\n    e.preventDefault();\r\n    this.props.form.validateFieldsAndScroll((err, values) => {\r\n      if (!err) {\r\n        let sendobj={'nickname':values.nickname,'user':this.props.userinfo.user};\r\n        axios({\r\n          url:modifyurl,\r\n          method:'post',\r\n          data:sendobj\r\n        }).then((res)=>{\r\n          let data=res.data;\r\n          if(data==='success'){\r\n            message.success(\"操作成功\");\r\n            this.props.getnickname(values.nickname);\r\n            this.setState({});\r\n          }else{\r\n            message.error(\"操作失败\");\r\n          }\r\n        }).catch((e)=>{console.log(e)});\r\n      }\r\n    })\r\n  }\r\n  render(){\r\n    const { getFieldDecorator } = this.props.form\r\n    const formItemLayout = {\r\n      labelCol: { span:6 },\r\n      wrapperCol: { span: 18 },\r\n    };\r\n    return(\r\n      <Form onSubmit={this.Submitnick}  layout='horizontal'>\r\n        <Form.Item label=\"修改昵称\" {...formItemLayout}  >\r\n          {getFieldDecorator('nickname', {\r\n            rules: [\r\n              {\r\n                required: true,\r\n                message: '请输入昵称',\r\n              },\r\n            ],\r\n            initialValue:this.props.userinfo.nickname\r\n          })(<Input />)}\r\n        </Form.Item>\r\n        <Form.Item >\r\n        <Button type=\"primary\" htmlType=\"submit\" style={{float:'right'}}>\r\n          修改\r\n        </Button>\r\n        </Form.Item>\r\n      </Form>\r\n    )\r\n  }\r\n}\r\nconst Modifynick=Form.create()(ModifynickForm)\r\n\r\nclass ModifypassForm extends React.Component{\r\n  state = {\r\n    confirmDirty: false,\r\n  };\r\n  compareToFirstPassword=(rule,value,callback) => {\r\n    const form=this.props.form;\r\n    if (value && value !== form.getFieldValue('password')) {\r\n      callback('两次密码输入不一致');\r\n    } else {\r\n      callback();\r\n    }\r\n  };\r\n  validateToNextPassword=(rule,value,callback) => {\r\n    const form = this.props.form;\r\n    if (value && this.state.confirmDirty) {\r\n      form.validateFields(['confirm'], { force: true });\r\n    }\r\n    callback();\r\n  };\r\n  handleConfirmBlur=(e)=>{\r\n    const value = e.target.value;\r\n    this.setState({ confirmDirty: this.state.confirmDirty || !!value });\r\n  };\r\n  Submitpass=(e)=>{\r\n    e.preventDefault();\r\n    this.props.form.validateFieldsAndScroll((err,values)=>{\r\n      if (!err) {\r\n        let sendobj={'password':values.password,'user':this.props.userinfo.user};\r\n        axios({\r\n          url:modifyurl,\r\n          method:'post',\r\n          data:sendobj\r\n        }).then((res)=>{\r\n          let data=res.data;\r\n          if(data==='success'){\r\n            message.success(\"操作成功\");\r\n            this.props.form.setFieldsValue({'password':''});\r\n            this.props.form.setFieldsValue({'confirm':''});\r\n            this.setState({});\r\n          }else{\r\n            message.error(\"操作失败\");\r\n          }\r\n        }).catch((e)=>{console.log(e)});\r\n      }\r\n    })\r\n  }\r\n  render(){\r\n    const { getFieldDecorator } = this.props.form\r\n    const formItemLayout = {\r\n      labelCol: { span:6 },\r\n      wrapperCol: { span: 18 },\r\n    };\r\n    return(\r\n      <Form onSubmit={this.Submitpass}  layout='horizontal'>\r\n        <Form.Item  label='修改密码' {...formItemLayout}>\r\n        {getFieldDecorator('password', {\r\n          rules: [\r\n            {\r\n              required: true,\r\n              message: '请输入密码',\r\n            },\r\n            {\r\n              validator: this.validateToNextPassword,\r\n            },\r\n          ],\r\n        })(<Input.Password placeholder=\"请输入密码\" />)}\r\n        </Form.Item>\r\n        <Form.Item  label='确认密码' {...formItemLayout}>\r\n        {getFieldDecorator('confirm', {\r\n          rules: [\r\n            {\r\n              required: true,\r\n              message: '请确认密码',\r\n            },\r\n            {\r\n              validator: this.compareToFirstPassword,\r\n            },\r\n          ],\r\n        })(<Input.Password onBlur={this.handleConfirmBlur} placeholder=\"请确认密码\" />)}\r\n        </Form.Item>        \r\n        <Form.Item >\r\n        <Button type=\"primary\" htmlType=\"submit\" style={{float:'right'}}>\r\n          修改\r\n        </Button>\r\n        </Form.Item>\r\n      </Form>\r\n    )\r\n  }\r\n}\r\nconst Modifypass=Form.create()(ModifypassForm)\r\n\r\nclass Modifyhead extends React.Component{\r\n  constructor(props){\r\n    super(props)\r\n    this.state = {\r\n      previewVisible: false,\r\n      previewImage: '',\r\n      fileList: [\r\n        {\r\n          uid: '-1',\r\n          url:props.userinfo.headurl,\r\n        }\r\n      ]\r\n    }\r\n  }\r\n  handleCancel=()=> this.setState({ previewVisible: false });\r\n  handlePreview = async file => {\r\n    if (!file.url && !file.preview) {\r\n      file.preview = await getBase64(file.originFileObj);\r\n    }\r\n    this.setState({\r\n      previewImage: file.url || file.preview,\r\n      previewVisible: true,\r\n    });\r\n  };\r\n  Submithead=(e)=>{\r\n    if(this.state.fileList[0]){\r\n      let headurl='/api/'+this.state.fileList[0].response.jpgurl;\r\n      let sendobj={'headurl':headurl,'user':this.props.userinfo.user};\r\n      axios({\r\n        url:modifyurl,\r\n        method:'post',\r\n        data:sendobj\r\n      }).then((res)=>{\r\n        let data=res.data;\r\n        if(data==='success'){\r\n          this.props.getheadurl(headurl);\r\n          message.success('更换成功');\r\n          this.setState({});\r\n        }else{\r\n          message.error('更换失败');\r\n        }\r\n      }).catch((e)=>{console.log(e)});\r\n    }\r\n  }\r\n  handleChange = ({ fileList }) => {console.log(fileList);this.setState({ fileList })};\r\n  render(){\r\n    const { previewVisible, previewImage, fileList } = this.state;\r\n    const uploadButton = (\r\n      <div>\r\n        <Icon type=\"plus\" />\r\n        <div className=\"ant-upload-text\">Upload</div>\r\n      </div>\r\n    );\r\n    return(\r\n      <div className='uploaddiv'>\r\n      <Upload\r\n        action={uploadurl}\r\n        listType=\"picture-card\"\r\n        fileList={fileList}\r\n        onPreview={this.handlePreview}\r\n        onChange={this.handleChange}\r\n      >\r\n        {fileList.length >= 1 ? null : uploadButton}\r\n      </Upload>\r\n      <Modal visible={previewVisible} footer={null} onCancel={this.handleCancel}>\r\n        <img alt=\"example\" style={{ width: '100%' }} src={previewImage} />\r\n      </Modal>\r\n      <Button onClick={this.Submithead} style={{width:'104px'}}>确认修改</Button>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nfunction getBase64(file) {\r\n  return new Promise((resolve, reject) => {\r\n    const reader = new FileReader();\r\n    reader.readAsDataURL(file);\r\n    reader.onload = () => resolve(reader.result);\r\n    reader.onerror = error => reject(error);\r\n  });\r\n}\r\n\r\nclass Profiledetail extends React.Component {\r\n  constructor(props){\r\n    super(props);\r\n    this.state = {\r\n      current:'nickname'\r\n    };\r\n    if(props.islogin){\r\n    }\r\n    else{\r\n      message.warn(\"请登录后使用\");\r\n      props.history.push('/article');\r\n    }\r\n  }\r\n  handleClick = e => {\r\n    this.setState({\r\n      current: e.key,\r\n    });\r\n  };\r\n  render() {\r\n   const userinfo={\r\n     'nickname':this.props.nickname,\r\n     'user':this.props.user,\r\n     'headurl':this.props.headurl\r\n    }\r\n    return (\r\n      <Row>\r\n        <Col xs={{span:0}} xl={{span:4}} style={{height:100}}></Col>\r\n        <Col xs={{span:4}} xl={{span:4}}>\r\n          <Menu\r\n            onClick={this.handleClick}\r\n            style={{ width: 256 }}\r\n            defaultSelectedKeys={['nickname']}\r\n            mode=\"inline\"\r\n          >\r\n            <Menu.Item key=\"nickname\">\r\n              <Icon type=\"user\" />修改昵称\r\n            </Menu.Item>\r\n            <Menu.Item key=\"lock\">\r\n              <Icon type=\"lock\" />修改密码\r\n            </Menu.Item>\r\n            <Menu.Item key=\"head\">\r\n              <Icon type=\"contacts\" />修改头像\r\n            </Menu.Item>\r\n          </Menu>\r\n        </Col>\r\n        <Col xs={{span:20}} xl={{span:8}}>\r\n          {this.state.current==='nickname'?\r\n          <Modifynick userinfo={userinfo} getnickname={this.props.getnickname}/>:\r\n          (this.state.current==='lock')?<Modifypass  userinfo={userinfo} />:\r\n          <Modifyhead  userinfo={userinfo} getheadurl={this.props.getheadurl}/>}\r\n        </Col>\r\n        <Col xs={{span:0}} xl={{span:8}}></Col>\r\n      </Row>\r\n    );\r\n  }\r\n}\r\nexport default connect((props,state)=>(Object.assign({},props,state)),{getnickname,getheadurl})(Profiledetail) \r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// <Form onSubmit={this.handleSubmit} className=\"login-form\">\r\n// <Form.Item>\r\n//   {getFieldDecorator('username', {\r\n//     rules: [\r\n//       {\r\n//         type: 'email',\r\n//         message: '请输入邮箱格式',\r\n//       },\r\n//       {\r\n//         required: true,\r\n//         message: '请输入邮箱',\r\n//       },\r\n//     ],\r\n//   })(\r\n//     <Input\r\n//       prefix={<Icon type=\"mail\" style={{ color: 'rgba(0,0,0,.25)' }} />}\r\n//       placeholder=\"请输入邮箱\"\r\n//     />,\r\n//   )}\r\n// </Form.Item>\r\n\r\n// <Form.Item>\r\n//   {getFieldDecorator('password', {\r\n//     rules: [{ required: true, message: '请输入密码' }],\r\n//   })(\r\n//     <Input\r\n//       prefix={<Icon type=\"lock\" style={{ color: 'rgba(0,0,0,.25)' }} />}\r\n//       type=\"password\"\r\n//       placeholder=\"请输入密码\"\r\n//     />,\r\n//   )}\r\n// </Form.Item>\r\n// <Form.Item>\r\n// <div>\r\n//   {getFieldDecorator('remember', {\r\n//     valuePropName: 'checked',\r\n//     initialValue: true,\r\n//   })(<Checkbox>记住我</Checkbox>)}\r\n//   <a className=\"login-form-forgot\" href=\"#\">\r\n//     忘记密码\r\n//   </a>\r\n//   </div>\r\n//   <Button type=\"primary\" htmlType=\"submit\" className=\"login-form-button\">\r\n//     登录\r\n//   </Button>\r\n\r\n// </Form.Item>\r\n\r\n\r\n\r\n\r\n\r\n\r\n// <div className=\"clearfix\">\r\n//   <Upload\r\n//     action=\"https://www.mocky.io/v2/5cc8019d300000980a055e76\"\r\n//     listType=\"picture-card\"\r\n//     fileList={fileList}\r\n//     onPreview={this.handlePreview}\r\n//     onChange={this.handleChange}\r\n//   >\r\n//     {fileList.length >= 1 ? null : uploadButton}\r\n//   </Upload>\r\n//   <Modal visible={previewVisible} footer={null} onCancel={this.handleCancel}>\r\n//   <img alt=\"example\" style={{ width: '100%' }} src={previewImage} />\r\n//   </Modal>\r\n// </div>\r\n\r\n\r\n\r\n// </Form>"]},"metadata":{},"sourceType":"module"}